# Drive Remote Controller

Данные программы позволяют по локальной сети управлять транспортными средствами в различных играх, предоставляя интерфейс в виде различных элементов управления, таких как руль, педали, ручной тормоз и другие элементы. 

Для работы необходимо установить хост-программу на Windows, а также само приложение-контроллер на Android. После в настройках обоих программ указать один и тот же порт для подключения, например, **65432**. Далее для подключения необходимо одновременно в обоих программах нажать на кнопку **Подключение**. Если в течении 5 секунд хост-программа и контроллер не подключятся друг к другу, соединение будет сброшено. 

## Хост-программа на Windows

При запуске в окне доступны две кнопки: **Подключение** и **Настройки**. В настойках укажите порт для подключения. Также можно указать тип управления для руля и педалей: аналоговое или цифровое. 

Для цифрового управления испольуется эмуляция нажатия клавиш, которые также можно настроить ниже. 

Для работы аналогового управления используется эмуляция стиков джойстика. Для работы аналогового управления используется драйвер vJoy, который можно скачать [здесь](https://github.com/shauleiz/vJoy/releases). Также нужно, чтобы в настройках контроллера также было указанно аналоговое управление для соответствующих элементов. 

## Приложение-контроллер на Android

Для запуска приложения можно использовать **Pydroid3**, либо собрать APK-файл через **buildozer**, используя .spec файл. 

При запуске приложения сразу доступно окно с элементами управления. Сверху доступен статус подключения, а в углу находится кнопка открытия настроек. В настройках необходимо указать IP-адрес компьютера, к которому будет происходить подключения, а также порт, который должен совпадать с портом, указанном в программе-хосте. После этого можно будет подключиться. 

В настройках также доступна настройка элементов управления. Можно выбрать аналоговый или цифровой тип управления для руля и педалей. При аналоговом управлении руль отображается в виде виджета руля, который можно вращать в обе стороны. Кол-во оборотов также можно настроить. При цифровом управлении руль заменяется на стрелки. Для педалей при аналоговом управлении сила нажатия зависит от высоты нажатия виджета. 

## Формат отправляемых данных

Данные от контроллера к хост-программе передаются через сокеты в виде строки значений, разделеные точкой с запятой. Все значения принимают значения от 0 до 1, аналоговые значения отправляются в виде числа с плавающей точкой. Пример формата отправляемых данных:

```
0.500;0.92;0;0;1;0;0;0;0;0;0;0;0
```

Для руля ровное положение соответсвует значение 0.5, поворот влево - 0, вправо - 1. Педали передают значение от 0 до 1 в зависимости от силы нажатия. Остальные значения определяют, нажата ли кнопка или нет. Формат отправляемых данных соответсвует следующим элементам управления:

```
Поворот_руля; нажатие_газа; нажатие_тормоза; нажатие_сцепления; нажатие_ручника; переход_на_повышенную_передачу; переход_на_пониженную_передачу; нажатие_сигналки; ключ_зажигания; переключение_фар; левый_поворотник; правый_поворотник; переключение_аварийки
```
